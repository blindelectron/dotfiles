# Руководство по эксплуатации z-Буфер обмена

С помощью z-Буфер обмена, мы получим возможность слышать сообщения об операциях: скопировано, вставлено, Отменено, вырезано и выделено всё.

Дополнение включает в себя возможность активировать и деактивировать звуковые сигналы или речевые сообщения, а также сохранение истории, которую можно скопировать в фокус курсора.
При включеной функции история, становится доступным монитор отслеживания с выбором интервала времени, а также опцией оповещения звуком, если в историю что-то добавлено.
В момент добавления текста в историю, производится проверка на наличие одинаковых фрагментов. Если такой фрагмент уже есть, то он не будет добавлен в список истории.

Это дополнение основано на дополнении Fake Clipboard.
### О дополнении

* Автор: Héctor J. Benítez Corredera
* E-mail: [xebolax@gmail.com](mailto:xebolax@gmail.com)
* Оригинальная идея: Peter Vagner
* E-mail: [peter.v@datagate.sk](mailto:peter.v@datagate.sk)
* [Страница дополнения на GitHub](https://github.com/hxebolax/zPortapapeles)
* Минимальная версия NVDA 2021.2.0
* Последнее тестируемая версия NVDA 2022.1.0

## Жесты ввода...

В разделе NVDA Жесты ввода....
Если мы найдем категорию z-Буфер обмена, мы сможем добавить комбинацию клавиш, которая по умолчанию не назначена для открытия окна истории буфера обмена.

У нас также будет раздел, где мы можем изменить клавиши запуска, относящиеся к буферу обмена, этот раздел может быть изменен только в том случае, если наш язык или система имеют другие клавиши, назначенные по умолчанию для буфера обмена.

Можно назначить клавиши для быстрого отключения и включения звуковых и голосовых уведомлений при выполнении операций,  таким образом будет доступно то что предлагает NVDA, при этом не отключая функцию истории буфера обмена.

## Настройки дополнения

В меню NVDA, Параметры, Настройки,  в категории z-Буфер обмена.
Мы можем активировать и деактивировать с помощью флажков, если хотим получать звуковые или речевые сообщения при выполнении операций.
Активировать историю буфера обмена.

Если флажок истории активирован, у нас будет доступно комбинированное поле, в котором можно выбрать интервал времени мониторинга буфера обмена, а также флажок, чтобы активировать или деактивировать, хотим ли мы слышать звук, когда что-то добавляется в историю.

Кроме этого, можно включить или отключить чтение текста, скопированного и добавленного в историю буфера обмена.

Если флажок  истории снят, то и комбинированное окно, и другие настройки для истории не появятся.

Обратите внимание, что если вы начинаете получать ошибки буфера обмена, возможно, вам следует увеличить время мониторинга буфера обмена.

## Диалог истории

Для этого диалога необходимо назначить комбинацию клавиш в жестах ввода, которая по умолчанию не назначена.

Диалог будет открыт только тогда, когда у вас есть сохраненная запись, пока у вас нет записей, вы не сможете открыть его.

Мы будем информированы обо всем информационными сообщениями, а также если диалог уже открыт.

Когда диалог открыт, он состоит из списка записей и следующих четырёх кнопок:

* Кнопка Удалить или Alt+B: Если мы нажмем эту кнопку, то удалим запись, на котором установлен курсор в списке.
* Кнопка Удалить все или Alt+T: Эта кнопка удалит все записи в списке истории.
* Кнопка Обновить или Alt+R: обновить историю с новыми добавленными записями, это будет полезно, если мы добавляем в историю буфера, когда диалог открыт.
* Кнопка Закрыть или Alt+C, Escape или Alt+F4: закрывает диалог истории.

Когда мы находимся в списке, при нажатии клавиши ENTER запись находящаяся под фокусом курсора, будет скопирована в приложение, которое находится за открытым окном истории.

Например, если у нас открыт блокнот, мы открываем историю и нажимаем ENTER на первой записи, это скопирует в блокнот выбранный нами элемент.

## Ограничения z-Буфер обмена.
z-Буфер обмена не совместим с другими установленными плагинами, которые делают то же самое, такими как Fake Clipboard или Clipspeak, могут быть и другие, и в этом случае вам придется отключить их, если вы хотите использовать z-Clipboard.

Обратите внимание, что записи истории будут удалены при перезапуске NVDA.

История буфера обмена Windows может содержать дубликаты записей, если вы используете историю буфера обмена z-Clipboard. Вам придется выбрать, какой из них вы хотите использовать.

### Клавиатурные команды из жестов ввода

* Отображает окно истории буфера обмена, команда не назначена.
* Предустановленные клавиши буфера обмена (изменяются только при различных раскладках буфера обмена)
 * клавиатура, все раскладки: control+A - Выделить всё.
* клавиатура, все раскладки: control+C - Скопировать.
* клавиатура, все раскладки: control+E - Выделить всё.
* клавиатура, все раскладки: control+V - Вставить.
* клавиатура, все раскладки: control+X - Вырезать.
* клавиатура, все раскладки: control+Z - Отменить

## Благодарности

* Хави Домингес: За его бескорыстную помощь и за вклад в функцию мониторинга буфера обмена.
* Португальский Бразилия: Pedro-hdias
* Русский: Валентин Куприянов
* Umut KORKMAZ: Для турецкого интерфейса и файлов справки.  


## Журнал изменений.

## Версия 0.4.

* Добавлен режим игры.

Чтобы активировать этот режим, необходимо назначить жест в менеджере ввода.

Этот режим будет полезен для тех игр, которые копируют в буфер обмена и нуждаются в переводе.

В дополнительных опциях у нас будет возможность увеличить частоту обновления буфера обмена и возможность выбора языка перевода.

Язык источника в данном случае игры будет определен автоматически, и скопированное в буфер обмена будет переведено на выбранный вами язык.

Пока включен игровой режим, все остальные дополнительные команды, включая историю буфера обмена, отключены.

## Версия 0.3.1.

* Переписана функция, предотвращающая запуск плагина на безопасных экранах.

* Добавлен арабский язык.

## Версия 0.3.

* Добавлено определение выделения текста при копировании.

* Добавлена возможность быстрого отключения/включения дополнительных функций буфера обмена.

* Добавлена поддержка клавиатур, использующих кириллические символы.

* Добавлены русский и бразильский португальский языки.

## Версия 0.2.

* Изменили все функции буфера обмена на cTypes.

Теперь работа с буфером обмена будет осуществляться непосредственно с помощью системных функций, избегая использования функций NVDA и wxpython.

* Подготовил плагин для перевода.

## Версия 0.1.5.

* Выступление копируется в буфер обмена и добавляется в Историю.

Если мы включили опцию Включить или отключить историю буфера обмена в опциях плагина, то теперь у нас появится эта новая опция.

С помощью этой опции скопированное в историю или, если оно уже есть, последнее скопированное в буфер обмена будет прочитано с помощью NVDA.

Будет упомянута только последняя скопированная строка и только один раз, чтобы не перенасыщать буфер обмена, пока не будет упомянута другая скопированная строка, предыдущая не будет повторяться.

* Буфер обмена будет удален при первом запуске плагина.

Теперь он больше не будет копировать то, что было в буфере обмена, когда мы запускали NVDA, теперь буфер обмена будет начинаться с чистого листа.

Это не влияет на историю буфера обмена Windows.

*** Предупреждение: это необходимо учитывать, так как это может удалить что-то важное в буфере обмена. ***

## Версия 0.1.4.

* Изменен способ получения данных из буфера обмена.

## Версия 0.1.3.

* Обновлено требование к дополнению до NVDA 2021.2 как минимальной версии для использования.

* Добавлены опции для истории.

Теперь мы можем выбрать время мониторинга, а также желаем ли мы услышать звук, когда что-то копируется в историю.

* Добавлена совместимость с Word и Excel, чтобы не объявлять клавиши буфера обмена.

* Буфер обмена теперь контролируется, поэтому любые плагины, копирующие в буфер обмена, теперь поддерживаются, даже NVDA copy to focus.

## Версия 0.1.2.

* Добавлено включение или отключение голосовых объявлений буфера обмена в опциях.

В разрешенных приложениях мы будем пропускать сообщения, соответствующие клавишам буфера обмена.

## Версия 0.1.1.

* Изменен способ управления захватами буфера обмена и управление ими.

* Исправлена ошибка, из-за которой буфер обмена оставался открытым.

## Версия 0.1.

* Начальная версия.